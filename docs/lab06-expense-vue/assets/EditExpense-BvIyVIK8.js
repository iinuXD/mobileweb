import{d as U,o as R,M as T,c as D,w as l,u as a,I as N,O as A,N as M,A as p,b as t,e as S,h as y,G as h,f as H,g as i,i as V,j as L,P as O,l as P,C as c,H as x,D as j,J as z,K as w,L as G,z as J,Q as K,B as Q}from"./index-QKFTy4HF.js";import{b as _,s as q,f as I,d as g,g as F,u as W,h as X}from"./firebase-CYBFCgeC.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z=U({__name:"EditExpense",setup($){const E=A(),v=M(),b=E.params.id,r=p(""),u=p(null),f=p("expense"),d=p(""),m=p("");R(async()=>{try{_.currentUser||await q(_)}catch(o){console.error("Auth failed:",o)}await C()});const C=async()=>{try{const o=I(g,"expenses",b),e=await F(o);if(e.exists()){const n=e.data();r.value=n.title||"",u.value=n.amount||0,f.value=n.type||"expense",d.value=n.category||"",m.value=n.note||""}else s("ไม่พบข้อมูล"),v.push("/tabs/tab1")}catch(o){console.error("Error loading expense:",o),s("เกิดข้อผิดพลาดในการโหลดข้อมูล")}},B=async()=>{if(!r.value.trim()){s("กรุณากรอกชื่อรายการ");return}if(!u.value||u.value<=0){s("กรุณากรอกจำนวนเงิน");return}if(!d.value.trim()){s("กรุณากรอกหมวดหมู่");return}try{const o=I(g,"expenses",b);await W(o,{title:r.value,amount:Number(u.value),type:f.value,category:d.value,note:m.value}),s("บันทึกการแก้ไขสำเร็จ"),v.push("/tabs/tab1")}catch(o){console.error("Error updating expense:",o);const e=(o==null?void 0:o.message)||"เกิดข้อผิดพลาดในการบันทึกข้อมูล";s(e)}},k=async()=>{await(await K.create({header:"ยืนยันการลบ",message:"คุณต้องการลบรายการนี้หรือไม่?",buttons:[{text:"ยกเลิก",role:"cancel"},{text:"ลบ",role:"destructive",handler:async()=>{try{const e=I(g,"expenses",b);await X(e),s("ลบรายการสำเร็จ"),v.push("/tabs/tab1")}catch(e){console.error("Error deleting expense:",e),s("เกิดข้อผิดพลาดในการลบข้อมูล")}}}]})).present()},s=async o=>{await(await T.create({message:o,duration:2e3,position:"bottom"})).present()};return(o,e)=>(Q(),D(a(N),null,{default:l(()=>[t(a(P),null,{default:l(()=>[t(a(S),null,{default:l(()=>[t(a(y),{slot:"start"},{default:l(()=>[t(a(h),{"default-href":"/tabs/tab1"})]),_:1}),t(a(H),null,{default:l(()=>[...e[5]||(e[5]=[i("แก้ไขรายการ",-1)])]),_:1}),t(a(y),{slot:"end"},{default:l(()=>[t(a(V),{onClick:k,color:"danger"},{default:l(()=>[t(a(L),{slot:"icon-only",icon:a(O)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),t(a(J),{class:"ion-padding"},{default:l(()=>[t(a(c),null,{default:l(()=>[t(a(x),{label:"ชื่อรายการ","label-placement":"floating",placeholder:"กรอกชื่อรายการ",modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n)},null,8,["modelValue"])]),_:1}),t(a(c),null,{default:l(()=>[t(a(x),{label:"จำนวนเงิน","label-placement":"floating",type:"number",placeholder:"0",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n)},null,8,["modelValue"])]),_:1}),t(a(c),null,{default:l(()=>[t(a(j),null,{default:l(()=>[...e[6]||(e[6]=[i("ประเภท",-1)])]),_:1}),t(a(z),{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value=n),interface:"popover"},{default:l(()=>[t(a(w),{value:"income"},{default:l(()=>[...e[7]||(e[7]=[i("รายรับ",-1)])]),_:1}),t(a(w),{value:"expense"},{default:l(()=>[...e[8]||(e[8]=[i("รายจ่าย",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(a(c),null,{default:l(()=>[t(a(x),{label:"หมวดหมู่","label-placement":"floating",placeholder:"เช่น อาหาร, ค่าน้ำ, เงินเดือน",modelValue:d.value,"onUpdate:modelValue":e[3]||(e[3]=n=>d.value=n)},null,8,["modelValue"])]),_:1}),t(a(c),null,{default:l(()=>[t(a(G),{label:"หมายเหตุ","label-placement":"floating",placeholder:"เพิ่มเติม (ไม่บังคับ)",rows:4,modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=n=>m.value=n)},null,8,["modelValue"])]),_:1}),t(a(V),{expand:"block",onClick:B,class:"ion-margin-top"},{default:l(()=>[...e[9]||(e[9]=[i(" บันทึกการแก้ไข ",-1)])]),_:1})]),_:1})]),_:1}))}}),le=Y(Z,[["__scopeId","data-v-d0996f29"]]);export{le as default};
